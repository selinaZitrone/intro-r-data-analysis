### Compare the flipper length of penguins using statistical tests

First, create subsets of the flipper length of all species as vectors:

```{r echo=TRUE}
library(palmerpenguins)
library(tidyverse)
adelie <- filter(penguins, species == "Adelie")$flipper_length_mm
gentoo <- filter(penguins, species == "Gentoo")$flipper_length_mm
chinstrap <- filter(penguins, species == "Chinstrap")$flipper_length_mm
```

#### Step 1: Test all groups for normality


**With Shapiro-Wilk**

The Shapiro-Wilk test suggests that Adelie and Chinstrap are normally distributed, but Gentoo is not.

```{r, echo=TRUE}
shapiro.test(adelie)
shapiro.test(gentoo)
shapiro.test(chinstrap)
```

**With QQ-plots**

```{r, echo=TRUE}
library(patchwork) # using patchwork to combine multiple plots into one
ch <- ggpubr::ggqqplot(chinstrap) + labs(title = "chinstrap")
ad <- ggpubr::ggqqplot(adelie) + labs(title = "adelie")
ge <- ggpubr::ggqqplot(gentoo) + labs(title = "gentoo")

ch + ge + ad
```

#### Compare Chinstrap vs. Adelie

Both are normally distributed, so we can compare variances for Chinstrap and Adelie penguins:

```{r, echo=TRUE}
var.test(chinstrap, adelie)
```

This indicates that the variances do not differ between Chinstrap and Adelie penguins.
Therefore, we can use a t-test to compare mean flipper length:

```{r echo=TRUE}
t.test(chinstrap, adelie)
```

The t-test suggests, that the mean flipper length differs between Chinstrap and Adelie penguins.

#### Compare Chinstrap vs. Gentoo

Gentoo is not normally distributed, so we can use a Wilcoxon-rank-sum test to compare
means:

```{r, echo=TRUE}
wilcox.test(chinstrap, gentoo)
```

The Wilcoxon tests suggests that the flipper lengths differ between Chinstrap and Gentoo penguins.

#### Compare Adelie vs. Gentoo

Gentoo is not normally distributed, so we can use a Wilcoxon-rank-sum test to compare
means:


```{r, echo=TRUE}
wilcox.test(adelie, gentoo)
```

The Wilcoxon tests suggests that the flipper lengths differ between Adelie and Gentoo penguins.


#### Visual comparison

The boxplot supports the findings of the statistical tests. Notches do not overlap.

```{r, echo=TRUE}
penguins %>%
  ggplot(aes(x = species, y = flipper_length_mm)) +
  geom_boxplot(notch = TRUE)
```

