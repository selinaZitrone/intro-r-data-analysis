You can download the R Markdown document with a solution for today's task 
<a href="./tasks/day2//solution_docs/penguin_paper_6.Rmd" download>here</a> and the bibliography file from <a href="./tasks/day2/solution_docs/references.bib" download>here</a>

::::: {.panelset}

::: {.panel}

# R Markdown file

````md

---
title: "The penguins of Antarctica"
author: "Selina Baldauf"
date: "25/3/2022"
output: 
  word_document:
    number_sections: true
    toc: true
    fig_caption: true
    df_print: "kable"
  pdf_document: 
    number_sections: true
    toc: true
    fig_caption: true
    df_print: "kable"
  html_document:
    number_sections: true
    toc: true
    toc_float: true
    code_folding: "hide"
    code_download: true
    highlight: "textmate"
    theme: "journal"
    df_print: "kable"
bibliography: references.bib
always_allow_html: true
urlcolor: "blue"
---

```{r setup, include=FALSE}`r ''`
knitr::opts_chunk$set(
  echo = FALSE, # code is included in output
  warning = FALSE, # don't show warnings
  message = FALSE # don't show messages
)
library(tidyverse)
library(palmerpenguins)
# packages for the tables
library(knitr)
library(kableExtra)
library(flextable)

# set flextable defaults
set_flextable_defaults(
  font.size = 12,
  theme_fun = theme_booktabs,
  digits = 1
)
```

# Introduction

There are three main penguin species in Antarctica 
(*Chinstrap*, *Gentoo*, *Adelie*). You can see them in the following figure:

![Artwork by [Allison Horst](https://twitter.com/allison_horst)](
https://github.com/allisonhorst/palmerpenguins/blob/master/man/figures/lter_penguins.png?raw=true)

In this paper we want to answer the following questions

1. How bill depth depends on bill length?
2. Which penguin species has the highest body mass?

# Methods

All analysis was done using R version 4.1.3 [@Rcore2022] and the R markdown package [@Allaire2021].

## The data

The data was collected on islands in Antarctica and published by @gorman2014. You can find the original paper with the title "Ecological sexual dimorphism and environmental variability within a community of Antarctic penguins (genus *Pygoscelis*)" [@gorman2014] in PLoS ONE[^1]

[^1]: paper available [here](https://doi.org/10.1371/journal.pone.0090081).

The data is published via the `palmerpenguins` R package [@horst2020] which you can find [on this website](https://allisonhorst.github.io/palmerpenguins/).

**The data contains (among others) the following measurements:**

- bill length
- bill depth
- body mass
- sex
  - male
  - female


## The analysis

We did some plots, calculated some summary statistics and a linear model of the 
form $y = ax + b + \epsilon$


# Results

```{r mean-penguin-species, include=FALSE}`r ''`
# calculate the mean body mass of the penguin species
adelie_mean <- penguins %>% filter(species == "Adelie") %>% 
                  pull(body_mass_g) %>% mean(na.rm = TRUE) 
chinstrap_mean <- penguins %>% filter(species == "Chinstrap") %>% 
                  pull(body_mass_g) %>% mean(na.rm = TRUE) 
gentoo_mean <- penguins %>% filter(species == "Gentoo") %>% 
                  pull(body_mass_g) %>% mean(na.rm = TRUE) 
```
The mean weight of all penguin species is 
`r knitr::inline_expr("mean(penguins$body_mass_g, na.rm = TRUE)")`. 
*Gentoo* penguins have an average weight of `r knitr::inline_expr("round(gentoo_mean,0)")` g,
*Adelie* penguins of `r knitr::inline_expr("round(adelie_mean, 0)")` g and 
*Chinstrap* penguins of `r knitr::inline_expr("round(chinstrap_mean, 0)")` g.


The figure below shows that *Gentoo* penguins have the highest body mass.

```{r histogram-body, fig.cap="Histogram of weight of the three penguin species.",
fig.width=4, fig.height=3, fig.align='center'}
ggplot(penguins, aes(x = body_mass_g, fill = species)) +
  geom_histogram(alpha = 0.6) +
   scale_fill_manual(values = c("darkorange", "purple", "cyan4")) +
   theme_minimal()
```

There is a positive relationship between bill length and bill depth for all 3 
species, as the figure below shows.

```{r scatterplot-bill, eval=FALSE, fig.cap="Scatter plot with regression lines
showing the relationship between bill length and bill depth for the 3 penguin species"}
ggplot(
  data = penguins,
  aes(
    x = bill_length_mm,
    y = bill_depth_mm,
    color = species,
    shape = species
  )
) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(values = c("darkorange", "purple", "cyan4")) +
  theme_minimal()
```
In general, it looks like the body characteristics differ between the sexes but
also between the penguin
species, as the table below illustrates:

```{r summary-table}`r ''`
penguins_sum <- penguins %>% 
  filter(!(is.na(sex))) %>% 
  group_by(species, sex) %>% 
  summarize(
    bill_length = mean(bill_length_mm, na.rm = TRUE),
    bill_depth = mean(bill_depth_mm, na.rm = TRUE),
    flipper_length = mean(flipper_length_mm, na.rm = TRUE),
    body_mass = mean(body_mass_g, na.rm = TRUE)
  )
```

```{r summary-table-flextable}`r ''`
penguins_sum %>% 
  flextable() %>%
  set_header_labels(
    bill_length = "Bill length (mm)",
    bill_depth = "Bill depth (mm)",
    flipper_length = "Flipper length (mm)",
    body_mass = "Body mass (g)"
  ) %>%
  set_caption(
    "Mean penguin variables with `flextable`"
  ) %>%
  colformat_double()
```


```{r summary-table-kableExtra}`r ''`
penguins_sum %>% 
  kable(
    digits = 1,
    col.names = c("Species", "Sex", "Bill length", "Bill depth", "Flipper length", "Body mass"),
    caption = "Mean penguin variables with `kable` and `kableExtra`",
    align = "c",
    booktabs = TRUE
  ) %>%
  kable_styling(
    latex_options = c("striped", "hold_position"),
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    position = "center"
  )
```

```{r summary-table-kableExtra-packed}`r ''`
penguins_sum %>%
  arrange(sex) %>%
  select(-sex) %>%
  kable(
    digits = 1,
    col.names = c("Species", "Bill length", "Bill depth", "Flipper length", "Body mass"),
    caption = "Mean penguin variables with `kable` and `kableExtra` and packed rows",
    align = "c",
    booktabs = TRUE
  ) %>%
  pack_rows("female", 1, 3) %>%
  pack_rows("male", 4, 6) %>%
  kable_paper() %>%
  kable_styling(
    latex_options = c("striped", "hold_position"),
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    position = "center"
  )
```
````

:::

::: {.panel}

# references.bib

```bibtex

@article{gorman2014,
	title = {Ecological Sexual Dimorphism and Environmental Variability within a Community of Antarctic Penguins (Genus Pygoscelis)},
	author = {{Gorman}, {Kristen B.} and {Williams}, {Tony D.} and {Fraser}, {William R.}},
	editor = {{Chiaradia}, {Andr√©}},
	year = {2014},
	month = {03},
	date = {2014-03-05},
	journal = {PLoS ONE},
	pages = {e90081},
	volume = {9},
	number = {3},
	doi = {10.1371/journal.pone.0090081},
	url = {http://dx.doi.org/10.1371/journal.pone.0090081},
	langid = {en}
}

@Manual{horst2020,
    title = {palmerpenguins: Palmer Archipelago (Antarctica) penguin data},
    author = {Allison Marie Horst and Alison Presmanes Hill and Kristen B Gorman},
    year = {2020},
    note = {R package version 0.1.0},
    doi = {10.5281/zenodo.3960218},
    url = {https://allisonhorst.github.io/palmerpenguins/},
  }
  
@Manual{Allaire2021,
    title = {rmarkdown: Dynamic Documents for R},
    author = {JJ Allaire and Yihui Xie and Jonathan McPherson and Javier Luraschi and Kevin Ushey and Aron Atkins and Hadley Wickham and Joe Cheng and Winston Chang and Richard Iannone},
    year = {2021},
    note = {R package version 2.11},
    url = {https://github.com/rstudio/rmarkdown},
  }
  
@Manual{Rcore2022,
    title = {R: A Language and Environment for Statistical Computing},
    author = {{R Core Team}},
    organization = {R Foundation for Statistical Computing},
    address = {Vienna, Austria},
    year = {2022},
    url = {https://www.R-project.org/},
  }

```

:::

:::::