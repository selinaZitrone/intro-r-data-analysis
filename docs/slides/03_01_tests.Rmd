---
subtitle: "Introduction to R - Day "
author: "Selina Baldauf"
institute: "Freie Universit√§t Berlin - Theoretical Ecology"
date: "2021-06-15"
output:
  xaringan::moon_reader:
    seal: false
    css: [default, css/new_slides.css]
    nature:
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: false
      beforeInit: "macros.js"
params:
  title: "Statistical tests"
  day: "3"
  bg_image: ""
  bg_image_scale: "30%"
  bg_position: "90% 90%"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, 
  warning = FALSE, 
  message = FALSE, 
  collapse = TRUE,
  fig.height = 6.3,
  fig.allign = 'center',
  fig.retina = 3.5,
  fig.showtext = TRUE
)
library(fontawesome)
library(tidyverse)
library(patchwork)

theme_set(theme_classic(base_size=16))
options(scipen = 0)
```

```{r child="title_slide.Rmd"}

```

```{r setup, include = FALSE}
library(tibble)
```

---
# Typical approach in statistics

.center[![](img/day3/statistics_approach.png)]

---
# Overview of tests

.center[![](img/day3/tests_overview.png)]

Note: Levene-test not necessary if you are interested in equal means but not equal variances!

---
class: inverse, center, middle

# .large[Tests for normal distribution]

---
# Test for normal distribution

There are **various tests** and the outcome might differ!

--

**Kolmogorov-Smirnov-Test (KS-Test)**

- how much does the cumulative probability of observed data differ from normal distribution
- very general test (also works for other distributions)
- low power: data not normally distributed but $H_0$ not rejected

--

**Shapiro-Wilk-Test**

- how much does variance of observed data differ from normal distribution
- specific test only for normal distribution
- high power, also for few data points

--

**Visual tests: QQ-Plot**

- quantiles of observed data plotted against quantiles of normal distribution
- scientist has to decide if normal or not

---
# Kolmogorov-Smirnov-Test

First, generate some normally distributed numbers (you would use real data instead).

```{r}
mydata <- tibble(
  some_var = rnorm(n = 200, mean = 50, sd = 5)
)
```

--

Use the `ks.test` function

```{r eval=FALSE}
ks.test(mydata$some_var, "pnorm", mean = mean(mydata$some_var), sd = sd(mydata$some_var))
```

---
# Short deviation: The `$` operator

With the `$` operator, you can select columns from a data frame / tibble.

The `$` operator will return the column as a **vector**

```{r}
mydata$some_var
```

In comparison to `dplyr::select()` which will return the colum as a **tibble**

```{r}
select(mydata, some_var)
```

---
# Kolmogorov-Smirnov-Test

Use the `ks.test` function

```{r}
ks.test(mydata$some_var, "pnorm", mean = mean(mydata$some_var), sd = sd(mydata$some_var))
```


The data does not deviate significantly from a normal distribution (KS-Test, D = ..., p > 0.05)

---
# Shapiro-Wilk-Test

Use the `shapiro.test` function:

```{r}
shapiro.test(mydata$some_var)
```

The data does not deviate significantly from a normal distribution (Shapiro-Wilk-Test, W = ..., p > 0.05)

---
# Visual test with QQ-Plot

Points should match the straight line. Small deviations are okay.

```{r}
qqnorm(mydata$some_var)
qqline(mydata$some_var)
```

---
class: inverse, center, middle

# .large[Tests for equal variance]

---
# Test for equal variance

- First step: test form normal distribution

If yes: **F-Test**

- calculates ratio of variances (if equal, ratio = 1)
- p: How likely is ratio if variances were equal?
- only for normal distribution

If no: **Levene test**

- compare difference between data sets with difference within data sets
- works with all distributions

---
# F-Test

Use the function `var.test`

```{r}
var.test(groupA, groupB)
```

Result: The variance of groups A and B do not differ significantly (F-Test, $F_{df,df}$ = ... , p > 0.05)

---
# Levene-Test

Use function `leveneTest` from `car` package


