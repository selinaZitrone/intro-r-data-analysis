{
  "hash": "fe927772b914c996683eda2185510197",
  "result": {
    "markdown": "---\ntitle: \"Bring your own data\"\nsubtitle: \"Day 4 - Introduction to Data Analysis with R\"\nauthor: \"Selina Baldauf\"\ninstitute: \"Freie Universität Berlin - Theoretical Ecology\"\ndate: today\ndate-format: long\nformat: \n  revealjs:\n    footer: \"Selina Baldauf // Bring your own data\"\n    highlight-style: breeze\n    mainfont: Cabinet Grotesk\n    slide-number: true\n    show-slide-number: all\n    incremental: false\n    self-contained: true\n    code-line-numbers: false\n    auto-stretch: false\n    scrollable: true\n    fig-align: center\n    theme: slides.scss\nexecute: \n  echo: true\n  warning: false\n  message: false\nfrom: markdown+emoji\n---\n\n\n\n## Organization\n\n**Schedule of today**\n\n- **Now - 14** (or 14.30 if you are enthusiastic still): Work on the data set(s)\n  - Take break(s) as best fits your needs\n\n- **14 (14.30) - 15**: Short feedback round\n\n  - What did you find out about your data set? Plots, summaries, ...\n  - Which methods did you use?\n  - Did you learn something new?\n  - Was there something you struggled with?\n  - ...\n  \n- **15-16**: Feedback, conclusion\n\n## New methods: Correlation plots\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-1_67443edeef8f8bba5ac90e635e2a4baf'}\n::: {.cell-output-display}\n![](bring-your-own-data_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](bring-your-own-data_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n\n\n\n## New methods: Correlation plots\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-2_5cd1346a90afa0f8a496626ef04b972a'}\n::: {.cell-output-display}\n![](bring-your-own-data_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n## New methods: PCAS\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-3_8d1d86b2fa7401ee7e69a6e16790c555'}\n::: {.cell-output-display}\n![](bring-your-own-data_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## New methods: Correlation plots and PCAS\n\n- [`corrplot` package](https://taiyun.github.io/corrplot/) for correlation plots\n- [`factoextra` package](https://rpkgs.datanovia.com/factoextra/index.html) for PCA visualization\n- [Tutorial for PCAs in R](http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/), [PCA tutorial for penguins](https://biodash.github.io/codeclub/s03e03_pca/)\n- Correlations and PCAs do not work with `NA` values: use `tidyr::drop_na()` to remove all `NA` values from the data first\n- These plots work for: penguins, wine, piecrab (?) dataset\n\n## Data set 1: What makes a good wine?\n\n**Physicochemical properties of wine and quality judgements**\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-4_69ac3624588b7bce90b84ee39f6b12b3'}\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t1599 obs. of  12 variables:\n $ fixed.acidity       : num  12.7 9.8 6.5 8.6 7.5 7.6 10.1 6.4 6.1 6.7 ...\n $ volatile.acidity    : num  0.6 0.66 0.88 0.52 0.58 0.5 0.935 0.4 0.58 0.46 ...\n $ citric.acid         : num  0.49 0.39 0.03 0.38 0.14 0.29 0.22 NA 0.23 0.24 ...\n $ residual.sugar      : num  2.8 3.2 NA 1.5 2.2 2.3 3.4 1.6 2.5 1.7 ...\n $ chlorides           : num  0.075 0.083 0.079 0.096 0.077 NA 0.105 0.066 0.044 0.077 ...\n $ free.sulfur.dioxide : num  5 21 23 5 27 5 11 5 16 18 ...\n $ total.sulfur.dioxide: num  NA 59 47 18 60 NA 86 12 70 34 ...\n $ density             : num  0.999 0.999 0.996 NA 0.996 ...\n $ pH                  : num  3.14 3.37 NA 3.2 3.28 3.32 3.43 3.34 3.46 3.39 ...\n $ sulphates           : num  0.57 0.71 0.5 0.52 0.59 NA 0.64 NA NA 0.6 ...\n $ alcohol             : num  11.4 11.5 11.2 9.4 9.8 11.5 11.3 9.2 12.5 10.6 ...\n $ quality             : int  5 7 4 5 5 6 4 5 6 6 ...\n```\n:::\n:::\n\n\n\n:::{.aside}\n\nReference: P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis.\nModeling wine preferences by data mining from physicochemical properties. In Decision Support Systems, Elsevier, 47(4):547-553, 2009.\n\n:::\n\n## Data set 1: What makes a good wine?\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n#### Ideas - know methods\n\n- Plot of wine quality against chemical properties\n- Plot of distribution of chemical properties\n- Summary tables using `dplyr`\n\n#### Ideas - new methods\n\n- **Correlation plots**: How are the different wine properties correlated with each other?\n- **PCA**: How are the wine properties related to each other?\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Frederik Vandaele - originally posted to Flickr as Château Pétrus, CC BY 2.0, https://commons.wikimedia.org/w/index.php?curid=5145286](img/wine.jpg)\n\n:::\n\n:::\n\n## Data set 1: What makes a good wine?\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n#### Hints\n\n- Transform the quality column to a factor before plotting: use `dplyr::mutate` and `as.factor()` to tranform the column\n- Try the `janitor::clean_names()` function\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Frederik Vandaele - originally posted to Flickr as Château Pétrus, CC BY 2.0, https://commons.wikimedia.org/w/index.php?curid=5145286](img/wine.jpg)\n\n:::\n\n:::\n\n## Data set 2: Paralympic games from 1980-2016\n\nMost important variables:\n\n|variable |class     |description |\n|:--------|:---------|:-----------|\n|gender   |character | Binary gender |\n|event    |character | Event name |\n|medal    |character | Medal type |\n|athlete  |character | Athlete name (LAST NAME first name|\n|abb      |character | Country abbreviation |\n|country  |character | Country name |\n|type     |character | Type of sport |\n|year     |double    | year of games |\n\n:::{.aside}\n\nSource: [International Paralympic Committee](https://db.ipc-services.org/sdms/hira/web/index) (provided by [tidytuesday](https://github.com/rfordatascience/tidytuesday/edit/master/data/2021/2021-08-03/readme.md))\n\n:::\n\n## Data set 2: Paralympic games from 1980-2016\n\nGet the data:\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-5_6380d61fc52bc6a10379fa886b2e1d3d'}\n\n```{.r .cell-code}\nathletes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-08-03/athletes.csv')\n```\n:::\n\n\n\n<br>\n\n#### Ideas - know methods\n\n- Create summaries of medal counts for different groups with `dplyr`\n- Did the ratio of men/women winning medals change over time?\n- Which countries were the most successful ones? Does this differ between sports type?\n  - Which types of sports accumulated the most medals?\n- Make plots such as:\n  - Age distribution of athletes winning gold, silver and bronze\n  - Compare the total number of medals over the years between winter and summer Olympics\n\n## Data set 2: Paralympic games from 1980-2016\n\n#### Hints\n\n- To reduce complexity of the data, first filter only the athletes that won a medal (`!is.na(medal)`)\n\n## Data set 3: Crab data set\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n**Atlantic marsh fiddler crab (*Minuca pugnax*)**\n\n- Crab from Florida is expanding northward due to ocean warming\n- Data on 13 marshes across a range of latitude in the USA\n- Recording of the size of of the crab\n- Rather small and good to handle\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Image by LTER under CC BY-SA 4.0](img/day4/lter.jpg)\n\n:::\n\n:::\n\n:::{.aside}\nSource: [Johnson, D. 2019.](https://doi.org/10.6073/pasta/4c27d2e778d3325d3830a5142e3839bb) Fiddler crab body size in salt marshes from Florida to Massachusetts, USA at PIE and VCR LTER and NOAA NERR sites during summer 2016. ver 1. Environmental Data Initiative.\n:::\n\n## Data set 3: Crab data set\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-6_c7df0afd9c6145b00afb67e6636c3002'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  date       latitude site   size air_temp air_temp_sd water_temp water_temp_sd\n  <date>        <dbl> <chr> <dbl>    <dbl>       <dbl>      <dbl>         <dbl>\n1 2016-07-24       30 GTM    12.4     21.8        6.39       24.5          6.12\n2 2016-07-24       30 GTM    14.2     21.8        6.39       24.5          6.12\n3 2016-07-24       30 GTM    14.5     21.8        6.39       24.5          6.12\n4 2016-07-24       30 GTM    12.9     21.8        6.39       24.5          6.12\n5 2016-07-24       30 GTM    12.4     21.8        6.39       24.5          6.12\n6 2016-07-24       30 GTM    13.0     21.8        6.39       24.5          6.12\n# ℹ 1 more variable: name <chr>\n```\n:::\n:::\n\n\n\n\n:::{.aside}\nSource: [Johnson, D. 2019.](https://doi.org/10.6073/pasta/4c27d2e778d3325d3830a5142e3839bb) Fiddler crab body size in salt marshes from Florida to Massachusetts, USA at PIE and VCR LTER and NOAA NERR sites during summer 2016. ver 1. Environmental Data Initiative.\n:::\n\n## Data set 3: Crab data set\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n**Ideas - known methods**\n\n- Explore Bergmann's rule (organisms are large in higher latitudes)\n- t-tests to compare size between locations\n- Plot relationship between latitude and size \n- Plot distributions of variables\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Image by LTER under CC BY-SA 4.0](img/day4/lter.jpg)\n\n:::\n\n:::\n\n\n:::{.aside}\nSource: [Johnson, D. 2019.](https://doi.org/10.6073/pasta/4c27d2e778d3325d3830a5142e3839bb) Fiddler crab body size in salt marshes from Florida to Massachusetts, USA at PIE and VCR LTER and NOAA NERR sites during summer 2016. ver 1. Environmental Data Initiative.\n:::\n\n## Data set 4: Ice cover and temperature\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n**Temperature and ice duration on lakes since 19th century**\n\n- 2 data sets with measurements of\n  - ice start, end and duration on 2 lakes in Wisconsin\n  - daily air temperature since 1870\n- Explore the effect of climate change on ice cover\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Image by LTER under CC BY-SA 4.0](img/day4/ice.jpg)\n\n:::\n\n:::\n\n:::{.aside}\n\nSource ice data: [Magnuson, J.J., S.R. Carpenter, and E.H. Stanley. 2021.](https://doi.org/10.6073/pasta/ab31f2489ee436beb73fc8f1d0213d97) North Temperate Lakes LTER: Ice Duration - Madison Lakes Area 1853 - current ver 35. Environmental Data Initiative. \n\nSource temperature data: [Anderson, L. and D. Robertson. 2020.](https://doi.org/10.6073/pasta/e3ff85971d817e9898bb8a83fb4c3a8b) Madison Wisconsin Daily Meteorological Data 1869 - current ver 32. Environmental Data Initiative.\n\n:::\n\n## Data set 4: Ice cover and temperature\n\nIce data:\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-7_cb14874364551b018d89f58e152144f2'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 5\n  lakeid       ice_on     ice_off    ice_duration  year\n  <fct>        <date>     <date>            <dbl> <dbl>\n1 Lake Mendota NA         1853-04-05           NA  1852\n2 Lake Mendota 1853-12-27 NA                   NA  1853\n3 Lake Mendota 1855-12-18 1856-04-14          118  1855\n4 Lake Mendota 1856-12-06 1857-05-06          151  1856\n5 Lake Mendota 1857-11-25 1858-03-26          121  1857\n6 Lake Mendota 1858-12-08 1859-03-14           96  1858\n```\n:::\n:::\n\n\n\nTemperature data:\n\n\n\n::: {.cell hash='bring-your-own-data_cache/html/unnamed-chunk-8_11311f73498cdf8da640ca1fd90923c2'}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 3\n  sampledate  year ave_air_temp_adjusted\n  <date>     <dbl>                 <dbl>\n1 1870-06-05  1870                  20  \n2 1870-06-06  1870                  18.3\n3 1870-06-07  1870                  17.5\n4 1870-06-09  1870                  13.3\n5 1870-06-10  1870                  13.9\n6 1870-06-11  1870                  15  \n```\n:::\n:::\n\n\n\n## Data set 4: Ice cover and temperature\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n**Ideas - known methods**\n\n- How did ice cover duration change over the years?\n- How did air temperature change over the years?\n  - Summarize mean annual temperature or mean temperature in winter\n- How do ice duration on the lakes correlate with temperature (e.g. with mean winter \n  temperature)\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Image by LTER under CC BY-SA 4.0](img/day4/ice.jpg)\n\n:::\n\n:::\n\n#### Hints\n\n- For some plots it might make sense to summarize annual means first\n- Use `left_join` to combined the tables with annual mean temperature and ice duration\n\n## Data set 5: RNAseq data\n\n- Data from [FU et al. 2015, *Nature Cell Biology*](https://www.nature.com/articles/ncb3117)\n- Data found via [Tutorial on heat maps](https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-heatmap2/tutorial.html) using this data\n\n- 3 csv files:\n  - `heatmap_genes.csv`: A list of the names of interesting genes to look at (Genes used in Figure 6b in paper)\n  - `DE_results.csv`: Gene expression in luminal cells in pregnant versus lactating mice\n    - logFC, AveExpr, t, p-value\n    - Also contains non-significantly expressed genes\n  - `normalized_counts`: Normalized counts for genes for the different samples\n  \n## Data set 5: RNAseq data\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n#### Ideas:\n\n- Create a heatmap of the top 20 most significant genes (see plot in the tutorial)\n- Create a heatmap of the interesting genes (see Fig. 6 in the paper)\n- Create a volcano plot of the data similar to the one [here](https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html)\n\n:::\n\n:::{.column width=\"50%\"}\n\n![](img/day4/volcano.png)\n\n:::\n\n:::\n\n## Data set 5: RNAseq data\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n![](img/day4/heat_top20.png)\n\n:::\n\n:::{.column width=\"50%\"}\n\n![](img/day4/heat_top20_2.png)\n\n:::\n\n:::\n\n## Data set 5: RNAseq data\n\n#### Some tips:\n\nData cleaning:\n\n  - Read in the data and then use the `janitor::clean_names` function to make the column headers nicer\n  - Join `DE_results` and `normalized_counts` by their shared columns\n  - Use `select` to remove columns you don't need for analysis to get a better overview\n  - Filter only significant genes ([tutorial](https://training.galaxyproject.org/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html)) defines them as `p_value < 0.01 & abs(logFC)` > 0.58)\n  \nData analysis:\n\n  - Heatmap with ggplot or with `pheatmap::pheatmap()`\n    - `pheatmap` takes a matrix as input (use `as_matrix` on tibble to transform)\n  - scale the counts -> have a look at the `scale` function\n    - `pheatmap` can scale but with ggplot you have to scale before plotting\n\n## Some general tips\n\n:::{.incremental}\n\n- First make a plan:\n  - What do you want to achieve and what are the steps?\n  - Try to think in technical terms\n- Start with something small, e.g. reading in the data and bringing it into the right format.\n- Google\n- If you get stuck, ask in the chat or stop by in General\n- Have a look at the [package cheat sheets](https://posit.co/resources/cheatsheets/)\n\n:::\n\n# Now you {.inverse}\n\n[Working with real research data]{.highlight-blue}<br>\n\n[**Meet** in your group (if you want)]{.big-text}<br>\n[**Work** on your data set]{.big-text}<br>\n[**Take breaks** as you need and **be back at 2 p.m.**]{.big-text}<br>\n[Keep an eye on your **group and the general chat**]{.big-text}<br>\n\n## Sharing\n\nIn 1-2 mins:\n\n- What was the highlight of your analysis?\n  - Your favorite plot\n  - Some cool code\n  - A problem that you finally solved\n  - Something new you learned\n\n- What was difficult?\n\n- If you want: Share a screenshot in the chat or share your screen\n\n## Feedback\n\nPlease take 10 mins to complete the feedback survey for the Graduate center (don't use Internet Explorer)<br>\n\n[https://votingo.cedis.fu-berlin.de/PCNLP3](https://votingo.cedis.fu-berlin.de/PCNLP3)\n\n## Feedback\n\n- Any other feedback or comments from your side?\n\n## Conclusion\n\n![](img/day1/datascience_workflow_tidyverse.png)\n\nWe learned a lot of stuff!\n\n## Conclusion\n\n#### How to continue from here?\n\n:::{.columns}\n\n:::{.column width=\"50%\"}\n\n- Learning by doing!\n- Have a look at some [online ressoures](https://selinazitrone.github.io/intro-r-data-analysis/online_resources.html), I recommend the R for Data Science book by Hadley Wickham\n- If you like plotting: Consider participating in the [tidytuesday](https://github.com/rfordatascience/tidytuesday)\n- [FU statistical consulting](http://www.stat.fu-berlin.de/en/dienstleistungen/index.html) for questions regarding statistical methods\n- [R Consulting by me](https://www.bcp.fu-berlin.de/en/graduiertenzentrum/promovierende/beratung/index.html)\n- [Tools and Tips lecture](https://selinazitrone.github.io/tools_and_tips/)\n\n:::\n\n:::{.column width=\"50%\"}\n\n![Artwork by [Allison Horst](https://twitter.com/allison_horst)](img/AllisonHorst/r_rollercoaster.png)\n\n:::\n\n:::\n\n# The End{.inverse}\n\n### Thanks a lot for participating!\n\n![Artwork by [Allison Horst](https://twitter.com/allison_horst)](img/AllisonHorst/heartyr.gif)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}