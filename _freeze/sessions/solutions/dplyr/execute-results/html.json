{
  "hash": "14e6705e6fb2c6a967bf275034ec4e6f",
  "result": {
    "markdown": "---\ntitle: \"Solution to dplyr tasks\"\n---\n\n\n## Get started\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-1_0853dd1a85eae0f411623b7fcf3191e5'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(palmerpenguins)\n```\n:::\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-2_43b3eda5571af4ea6b0af17a10f750db'}\n\n:::\n\n\n## Data transformation with dplyr\n\n**Find all penguins that ...**\n\n1. ... have a bill length between 40 and 45 mm.\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-3_8dc9e35e909d894cb1944b4b3bc140dc'}\n\n```{.r .cell-code}\nfilter(penguins, between(bill_length_mm, 40, 45))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 77 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           40.3          18                 195        3250\n 2 Adelie  Torgersen           42            20.2               190        4250\n 3 Adelie  Torgersen           41.1          17.6               182        3200\n 4 Adelie  Torgersen           42.5          20.7               197        4500\n 5 Adelie  Biscoe              40.6          18.6               183        3550\n 6 Adelie  Biscoe              40.5          17.9               187        3200\n 7 Adelie  Biscoe              40.5          18.9               180        3950\n 8 Adelie  Dream               40.9          18.9               184        3900\n 9 Adelie  Dream               42.2          18.5               180        3550\n10 Adelie  Dream               40.8          18.4               195        3900\n# ℹ 67 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n\n```{.r .cell-code}\n# same as \n# filter(penguins, bill_length_mm < 45 & bill_length_mm > 40)\n```\n:::\n\n\n2. ... for which we know the sex.\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-4_482eaf029d40113590e4571b86149fef'}\n\n```{.r .cell-code}\nfilter(penguins, !is.na(sex))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 333 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           36.7          19.3               193        3450\n 5 Adelie  Torgersen           39.3          20.6               190        3650\n 6 Adelie  Torgersen           38.9          17.8               181        3625\n 7 Adelie  Torgersen           39.2          19.6               195        4675\n 8 Adelie  Torgersen           41.1          17.6               182        3200\n 9 Adelie  Torgersen           38.6          21.2               191        3800\n10 Adelie  Torgersen           34.6          21.1               198        4400\n# ℹ 323 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n:::\n\n\n3. ... which are of the species Adelie or Gentoo and live either on Dream or on Torgersen\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-5_e2a01ed055d34825d76e1704e8726d46'}\n\n```{.r .cell-code}\nfilter(penguins, species %in% c(\"Adelie\", \"Gentoo\") &\n  island %in% c(\"Dream\", \"Torgersen\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 108 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 98 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n:::\n\n```{.r .cell-code}\n# or\n# filter(penguins, (species == \"Adelie\" | species == \"Gentoo\") &\n#   (island == \"Dream\" | island == \"Torgersen\"))\n```\n:::\n\n\n4. ... lived on the island Dream in the year 2007. How many of them were from each of the 3 species?\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-6_f50940f38ba231c609bc5b7ddd8d76be'}\n\n```{.r .cell-code}\nfilter(penguins, island == \"Dream\" & year == 2007) |> \n  count(species)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  species       n\n  <fct>     <int>\n1 Adelie       20\n2 Chinstrap    26\n```\n:::\n:::\n\n\n**Count ...**\n\n1. ... the number of penguins on each island.\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-7_03cd5e16900089a4ce8187c4d4e2e5c3'}\n\n```{.r .cell-code}\ncount(penguins, island)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 2\n  island        n\n  <fct>     <int>\n1 Biscoe      168\n2 Dream       124\n3 Torgersen    52\n```\n:::\n:::\n\n\n2. ... the number of penguins of each species on each island.\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-8_3bb4ccf8d8ae97bc6c24f571d8c328fa'}\n\n```{.r .cell-code}\ncount(penguins, island, species)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  island    species       n\n  <fct>     <fct>     <int>\n1 Biscoe    Adelie       44\n2 Biscoe    Gentoo      124\n3 Dream     Adelie       56\n4 Dream     Chinstrap    68\n5 Torgersen Adelie       52\n```\n:::\n:::\n\n\n**Select ...**\n\n1. ... only the variables species, sex and year\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-9_1b3d0947859ae316e975b691e7986598'}\n\n```{.r .cell-code}\nselect(penguins, species, sex, year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 3\n   species sex     year\n   <fct>   <fct>  <int>\n 1 Adelie  male    2007\n 2 Adelie  female  2007\n 3 Adelie  female  2007\n 4 Adelie  <NA>    2007\n 5 Adelie  female  2007\n 6 Adelie  male    2007\n 7 Adelie  female  2007\n 8 Adelie  male    2007\n 9 Adelie  <NA>    2007\n10 Adelie  <NA>    2007\n# ℹ 334 more rows\n```\n:::\n:::\n\n\n2. ... variables based on the following vector\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-10_6d788cd53a124c0c368fc8bdfa4aafd9'}\n\n```{.r .cell-code}\ncols <- c(\"species\", \"bill_length_mm\", \"flipper_length_mm\", \"body_mass_kg\")\nselect(penguins, any_of(cols))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 3\n   species bill_length_mm flipper_length_mm\n   <fct>            <dbl>             <int>\n 1 Adelie            39.1               181\n 2 Adelie            39.5               186\n 3 Adelie            40.3               195\n 4 Adelie            NA                  NA\n 5 Adelie            36.7               193\n 6 Adelie            39.3               190\n 7 Adelie            38.9               181\n 8 Adelie            39.2               195\n 9 Adelie            34.1               193\n10 Adelie            42                 190\n# ℹ 334 more rows\n```\n:::\n\n```{.r .cell-code}\n# this would return  an error\nselect(penguins, all_of(cols))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `all_of()`:\n! Can't subset columns that don't exist.\n✖ Column `body_mass_kg` doesn't exist.\n```\n:::\n:::\n\n\n3. ... only columns that contain measurements in mm\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-11_ce21596f5364cde4ef14da4e388351bf'}\n\n```{.r .cell-code}\nselect(penguins, ends_with(\"mm\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 3\n   bill_length_mm bill_depth_mm flipper_length_mm\n            <dbl>         <dbl>             <int>\n 1           39.1          18.7               181\n 2           39.5          17.4               186\n 3           40.3          18                 195\n 4           NA            NA                  NA\n 5           36.7          19.3               193\n 6           39.3          20.6               190\n 7           38.9          17.8               181\n 8           39.2          19.6               195\n 9           34.1          18.1               193\n10           42            20.2               190\n# ℹ 334 more rows\n```\n:::\n\n```{.r .cell-code}\n# or\n#select(penguins, contains(\"_mm\"))\n```\n:::\n\n\n**Add a column ...**\n\n1. ... with the ratio of bill length to bill depth\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-12_5eca26d70efb404d2aed363bc445f1a3'}\n\n```{.r .cell-code}\nmutate(penguins,\n       ratio = bill_length_mm / bill_depth_mm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 9\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 3 more variables: sex <fct>, year <int>, ratio <dbl>\n```\n:::\n:::\n\n\n2. ... with abbreviations for the species (Adelie = A, Gentoo = G, Chinstrap = C).\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-13_242456a8836d6ac8a309ebadadc92824'}\n\n```{.r .cell-code}\nmutate(penguins,\n       species_short = case_when(\n         species == \"Adelie\" ~ \"A\",\n         species == \"Gentoo\" ~ \"G\",\n         species == \"Chinstrap\" ~ \"C\"\n       ))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 344 × 9\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 3 more variables: sex <fct>, year <int>, species_short <chr>\n```\n:::\n:::\n\n\n**Calculate ...**\n\n1. ... mean flipper length and body mass for the 3 species and male and female penguins separately\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-14_a8eb098e8e95793651031d2d00fac87e'}\n\n```{.r .cell-code}\npenguins |>\n  group_by(species, sex) |>\n  summarize(\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    mean_body = mean(body_mass_g, na.rm = TRUE)\n  )  \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'species'. You can override using the\n`.groups` argument.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 4\n# Groups:   species [3]\n  species   sex    mean_flipper mean_body\n  <fct>     <fct>         <dbl>     <dbl>\n1 Adelie    female         188.     3369.\n2 Adelie    male           192.     4043.\n3 Adelie    <NA>           186.     3540 \n4 Chinstrap female         192.     3527.\n5 Chinstrap male           200.     3939.\n6 Gentoo    female         213.     4680.\n7 Gentoo    male           222.     5485.\n8 Gentoo    <NA>           216.     4588.\n```\n:::\n:::\n\n\n2. Can you do the same but remove the penguins for which we don't know the sex first?\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-15_7af94afc1adca787c1f67f8205ef371a'}\n\n```{.r .cell-code}\npenguins |> \n  filter(!is.na(sex)) |> \n  group_by(species, sex) |> \n  summarize(\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    mean_body = mean(body_mass_g, na.rm = TRUE)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'species'. You can override using the\n`.groups` argument.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 4\n# Groups:   species [3]\n  species   sex    mean_flipper mean_body\n  <fct>     <fct>         <dbl>     <dbl>\n1 Adelie    female         188.     3369.\n2 Adelie    male           192.     4043.\n3 Chinstrap female         192.     3527.\n4 Chinstrap male           200.     3939.\n5 Gentoo    female         213.     4680.\n6 Gentoo    male           222.     5485.\n```\n:::\n:::\n\n\n## Extras\n\n1. Make a boxplot of penguin body mass with sex on the y-axis and facets for the different species. Can you remove the penguins with missing values for sex first?\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-16_b3d84763769e5b755b731caa61a2d9b3'}\n\n```{.r .cell-code}\npenguins |>\n  filter(!is.na(sex)) |>\n  ggplot(aes(x = sex, y = body_mass_g)) +\n  geom_boxplot() +\n  facet_wrap(~species)\n```\n\n::: {.cell-output-display}\n![](dplyr_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n2. Make a scatterplot with the ratio of bill length to bill depth on the y axis and flipper length on the x axis? Can you distinguish the point between male and female penguins and remove penguins with unknown sex before making the plot?\n\n\n::: {.cell hash='dplyr_cache/html/unnamed-chunk-17_cb8f660db55f67be6492012375483e7d'}\n\n```{.r .cell-code}\npenguins |>\n  mutate(ratio = bill_length_mm / bill_depth_mm) |>\n  filter(!is.na(sex)) |>\n  ggplot(aes(x = flipper_length_mm, y = ratio, color = sex)) +\n  geom_point() +\n  scale_color_manual(values = c(\"cyan4\", \"darkorange\")) +\n  labs(\n    x = \"Flipper lenght (mm)\",\n    y = \"Ratio bill length / bill depth (-)\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](dplyr_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}