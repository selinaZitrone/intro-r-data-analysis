{
  "hash": "be9a71a26ee9c307c115cd690d721131",
  "result": {
    "markdown": "---\ntitle: \"Solution to tidyr task\"\ncode-line-numbers: false\n---\n\n\n## Get started\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-1_0c890bd33fb7e499a1662b5ad78e8d36'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Let's tidy some data sets\n\n**1. `relig_income`**\n\nHave a look at the `relig_income` data set that is included in tidyverse package.\nThe data set contains the results of a survey asking people about their religion and income category.\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-2_1b708dde7be4f1b0ceec97973e4763d0'}\n\n```{.r .cell-code}\nrelig_income\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 18 × 11\n   religion `<$10k` `$10-20k` `$20-30k` `$30-40k` `$40-50k` `$50-75k` `$75-100k`\n   <chr>      <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>      <dbl>\n 1 Agnostic      27        34        60        81        76       137        122\n 2 Atheist       12        27        37        52        35        70         73\n 3 Buddhist      27        21        30        34        33        58         62\n 4 Catholic     418       617       732       670       638      1116        949\n 5 Don’t k…      15        14        15        11        10        35         21\n 6 Evangel…     575       869      1064       982       881      1486        949\n 7 Hindu          1         9         7         9        11        34         47\n 8 Histori…     228       244       236       238       197       223        131\n 9 Jehovah…      20        27        24        24        21        30         15\n10 Jewish        19        19        25        25        30        95         69\n11 Mainlin…     289       495       619       655       651      1107        939\n12 Mormon        29        40        48        51        56       112         85\n13 Muslim         6         7         9        10         9        23         16\n14 Orthodox      13        17        23        32        32        47         38\n15 Other C…       9         7        11        13        13        14         18\n16 Other F…      20        33        40        46        49        63         46\n17 Other W…       5         2         3         4         2         7          3\n18 Unaffil…     217       299       374       365       341       528        407\n# ℹ 3 more variables: `$100-150k` <dbl>, `>150k` <dbl>,\n#   `Don't know/refused` <dbl>\n```\n:::\n:::\n\n\nWhat is not tidy about this data set?\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\"/></svg>`{=html} The variable income is spread across multiple columns, so we have to use `pivot_longer` to pivot the columns containing the income information:\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-3_73ff081324e91275ef894ff65a65bf9c'}\n\n```{.r .cell-code}\npivot_longer(relig_income,\n             cols = !religion,\n             names_to = \"income\",\n             values_to = \"count\"\n             )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 180 × 3\n   religion income             count\n   <chr>    <chr>              <dbl>\n 1 Agnostic <$10k                 27\n 2 Agnostic $10-20k               34\n 3 Agnostic $20-30k               60\n 4 Agnostic $30-40k               81\n 5 Agnostic $40-50k               76\n 6 Agnostic $50-75k              137\n 7 Agnostic $75-100k             122\n 8 Agnostic $100-150k            109\n 9 Agnostic >150k                 84\n10 Agnostic Don't know/refused    96\n# ℹ 170 more rows\n```\n:::\n:::\n\n\n\n**2. `billboard`**\n\nHave a look at the `billboard` data set that is included in the tidyverse package.\nThe data set contains information about the chart rank of songs in the year 2000.\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-4_e68b7be15e5cfe3372276433a0b91d75'}\n\n```{.r .cell-code}\nbillboard\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 317 × 79\n   artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8\n   <chr>      <chr> <date>       <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA\n 2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA\n 3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53\n 4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59\n 5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49\n 6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2\n 7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA\n 8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38\n 9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14\n10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58\n# ℹ 307 more rows\n# ℹ 68 more variables: wk9 <dbl>, wk10 <dbl>, wk11 <dbl>, wk12 <dbl>,\n#   wk13 <dbl>, wk14 <dbl>, wk15 <dbl>, wk16 <dbl>, wk17 <dbl>, wk18 <dbl>,\n#   wk19 <dbl>, wk20 <dbl>, wk21 <dbl>, wk22 <dbl>, wk23 <dbl>, wk24 <dbl>,\n#   wk25 <dbl>, wk26 <dbl>, wk27 <dbl>, wk28 <dbl>, wk29 <dbl>, wk30 <dbl>,\n#   wk31 <dbl>, wk32 <dbl>, wk33 <dbl>, wk34 <dbl>, wk35 <dbl>, wk36 <dbl>,\n#   wk37 <dbl>, wk38 <dbl>, wk39 <dbl>, wk40 <dbl>, wk41 <dbl>, wk42 <dbl>, …\n```\n:::\n:::\n\n\nWhat is not tidy about this data set?\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 448 512\" style=\"height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z\"/></svg>`{=html} The variable week is spread across multiple columns. We have to use pivot longer to pivot the week columns:\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-5_9b23814e797cf1d29b12979aaf833f96'}\n\n```{.r .cell-code}\npivot_longer(billboard,\n             cols = wk1:wk76,\n             names_to = \"week\",\n             values_to = \"rank\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 24,092 × 5\n   artist track                   date.entered week   rank\n   <chr>  <chr>                   <date>       <chr> <dbl>\n 1 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk1      87\n 2 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk2      82\n 3 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk3      72\n 4 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk4      77\n 5 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk5      87\n 6 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk6      94\n 7 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk7      99\n 8 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk8      NA\n 9 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk9      NA\n10 2 Pac  Baby Don't Cry (Keep... 2000-02-26   wk10     NA\n# ℹ 24,082 more rows\n```\n:::\n:::\n\n\n## Extras\n\n**`values_drop_na` argument**\n\nThe argument `values_drop_na` drops rows with missing values in the rank column. Here it makes sense because not every song is in the charts for all 76 weeks.\n\nWith the `names_prefix` argument we can remove the `wk` before the values of the week variable. This makes it easier to work with later.\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-6_8c19dfee9c10072bfafdec55161e7037'}\n\n```{.r .cell-code}\npivot_longer(billboard,\n             cols = wk1:wk76,\n             names_to = \"week\",\n             names_prefix = \"wk\",\n             values_to = \"rank\",\n             values_drop_na = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5,307 × 5\n   artist  track                   date.entered week   rank\n   <chr>   <chr>                   <date>       <chr> <dbl>\n 1 2 Pac   Baby Don't Cry (Keep... 2000-02-26   1        87\n 2 2 Pac   Baby Don't Cry (Keep... 2000-02-26   2        82\n 3 2 Pac   Baby Don't Cry (Keep... 2000-02-26   3        72\n 4 2 Pac   Baby Don't Cry (Keep... 2000-02-26   4        77\n 5 2 Pac   Baby Don't Cry (Keep... 2000-02-26   5        87\n 6 2 Pac   Baby Don't Cry (Keep... 2000-02-26   6        94\n 7 2 Pac   Baby Don't Cry (Keep... 2000-02-26   7        99\n 8 2Ge+her The Hardest Part Of ... 2000-09-02   1        91\n 9 2Ge+her The Hardest Part Of ... 2000-09-02   2        87\n10 2Ge+her The Hardest Part Of ... 2000-09-02   3        92\n# ℹ 5,297 more rows\n```\n:::\n:::\n\n\n**Recreating the penguin plot**\n\nTo recreate the penguin plot from the task, the following observations help:\n\n- Information needed: Species, bill depth and bill length\n  - In a first step, you can therefore use `select` from `dplyr` to select only these\n  three columns\n- Aesthetics are: Species on x-axis, value of bill depth and length on y-axis, \nfill aesthetic is category bill depth or bill length.\n  - This needs some reformatting. You need one value column with the measurements,\n  and one name column with the category. You can use pivot longer for this\n  \nUse the pipe operator to do the calculations one after the other:\n\n\n::: {.cell hash='tidyr_cache/html/unnamed-chunk-7_74992e514918e68016b2d29283afb491'}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\npenguins |> \n  select(species, bill_length_mm, bill_depth_mm) |> \n  pivot_longer(!species, names_to = \"variable\") |> \n  ggplot(aes(x = species, y = value, fill = variable)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](tidyr_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}