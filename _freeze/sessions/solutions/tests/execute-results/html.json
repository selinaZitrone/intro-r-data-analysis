{
  "hash": "60e540efc899df0e9a1afc66ce8d2253",
  "result": {
    "markdown": "---\ntitle: \"Solution to statistical test task\"\ncode-line-numbers: false\n---\n\n\n## Compare the flipper length of penguins using statistical tests\n\nFirst, create subsets of the flipper length of all species as vectors:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-1_2c69de83be3263c0a9c0c687290d1be5'}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\nlibrary(tidyverse)\nadelie <- filter(penguins, species == \"Adelie\")$flipper_length_mm\ngentoo <- filter(penguins, species == \"Gentoo\")$flipper_length_mm\nchinstrap <- filter(penguins, species == \"Chinstrap\")$flipper_length_mm\n```\n:::\n\n\n### Step 1: Test all groups for normality\n\n**With Shapiro-Wilk**\n\nThe Shapiro-Wilk test suggests that Adelie and Chinstrap are normally distributed, but Gentoo is not.\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-2_dc8b3834dbd5587a2a6e493b2dab691c'}\n\n```{.r .cell-code}\nshapiro.test(adelie)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  adelie\nW = 0.99339, p-value = 0.72\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(gentoo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  gentoo\nW = 0.96219, p-value = 0.00162\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(chinstrap)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  chinstrap\nW = 0.98891, p-value = 0.8106\n```\n:::\n:::\n\n\n**With QQ-plots**\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-3_80bca0b3c2f36988c2fb7634bd05cadc'}\n\n```{.r .cell-code}\nlibrary(patchwork) # using patchwork to combine multiple plots into one\nch <- ggpubr::ggqqplot(chinstrap) + labs(title = \"chinstrap\")\nad <- ggpubr::ggqqplot(adelie) + labs(title = \"adelie\")\nge <- ggpubr::ggqqplot(gentoo) + labs(title = \"gentoo\")\n\nch + ge + ad\n```\n\n::: {.cell-output-display}\n![](tests_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### Compare Chinstrap vs. Adelie\n\nBoth are normally distributed, so we can compare variances for Chinstrap and Adelie penguins:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-4_42de9b7d1351e9884fe7749846e50cbb'}\n\n```{.r .cell-code}\nvar.test(chinstrap, adelie)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  chinstrap and adelie\nF = 1.1894, num df = 67, denom df = 150, p-value = 0.3854\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.8022092 1.8217141\nsample estimates:\nratio of variances \n          1.189396 \n```\n:::\n:::\n\n\nThis indicates that the variances do not differ between Chinstrap and Adelie penguins.\nTherefore, we can use a t-test to compare mean flipper length:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-5_0885005926d8f4a15e4700ab75e29722'}\n\n```{.r .cell-code}\nt.test(chinstrap, adelie)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  chinstrap and adelie\nt = 5.7804, df = 119.68, p-value = 6.049e-08\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.859244 7.880530\nsample estimates:\nmean of x mean of y \n 195.8235  189.9536 \n```\n:::\n:::\n\n\nThe t-test suggests, that the mean flipper length differs between Chinstrap and Adelie penguins.\n\n### Compare Chinstrap vs. Gentoo\n\nGentoo is not normally distributed, so we can use a Wilcoxon-rank-sum test to compare\nmeans:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-6_dab8b0d05a80e16c786a6bb95303c0cd'}\n\n```{.r .cell-code}\nwilcox.test(chinstrap, gentoo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  chinstrap and gentoo\nW = 92, p-value < 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\nThe Wilcoxon tests suggests that the flipper lengths differ between Chinstrap and Gentoo penguins.\n\n### Compare Adelie vs. Gentoo\n\nGentoo is not normally distributed, so we can use a Wilcoxon-rank-sum test to compare\nmeans:\n\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-7_37e939eef2fae0e8d4d0a9e35bf954ab'}\n\n```{.r .cell-code}\nwilcox.test(adelie, gentoo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  adelie and gentoo\nW = 26, p-value < 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\nThe Wilcoxon tests suggests that the flipper lengths differ between Adelie and Gentoo penguins.\n\n\n### Visual comparison\n\nThe boxplot supports the findings of the statistical tests. Notches do not overlap.\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-8_6b98f8794cd690935325f76fbaf3894a'}\n\n```{.r .cell-code}\npenguins |> \n  ggplot(aes(x = species, y = flipper_length_mm)) +\n  geom_boxplot(notch = TRUE)\n```\n\n::: {.cell-output-display}\n![](tests_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nSimilarly the standard errors of the means do not overlap between the species.\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-9_c90657db53c8a1c4817104dc09dd3202'}\n\n```{.r .cell-code}\npenguins |>\n  ggplot(aes(x = species, y = flipper_length_mm)) +\n  stat_summary() \n```\n\n::: {.cell-output-display}\n![](tests_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nTo add the significance levels of the tests performed, I used\nthe `geom_signif()` layer provided by the `ggsignif` package.\n\nSince I performed two different tests (t-test for the comparison of Chinstrap and\nAdelie penguins, Wilcoxon test for the other two comparisons), I added two \ndifferent significance layers that distinguish the two tests.\n\nFor the boxplot:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-10_149b86c296181961129f82bec64968fb'}\n\n```{.r .cell-code}\nlibrary(ggsignif)\npenguins |> \n  ggplot(aes(x = species, y = flipper_length_mm)) +\n  geom_boxplot(notch = TRUE) +\n  geom_signif(\n    comparisons = list(\n      c(\"Chinstrap\", \"Adelie\")\n    ),\n    test = \"t.test\",\n    test.args = list(var.equal = TRUE),\n    map_signif_level = TRUE\n  ) +\n  geom_signif(\n    comparisons = list(\n      c(\"Chinstrap\", \"Gentoo\"),\n      c(\"Gentoo\", \"Adelie\")\n    ),\n    test = \"wilcox.test\",\n    y_position = c(235, 240),\n    map_signif_level = TRUE\n  )\n```\n\n::: {.cell-output-display}\n![](tests_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nFor a plot with mean and errorbar:\n\n\n::: {.cell hash='tests_cache/html/unnamed-chunk-11_ac28a822c398a28f623a1295600f5379'}\n\n```{.r .cell-code}\npenguins |> \n  ggplot(aes(x = species, y = flipper_length_mm)) +\n  stat_summary() +\n  geom_signif(\n    comparisons = list(\n      c(\"Chinstrap\", \"Adelie\")\n    ),\n    test = \"t.test\",\n    test.args = list(var.equal = TRUE),\n    map_signif_level = TRUE,\n    y_position = 200,\n    tip_length = 0.01\n  ) +\n  geom_signif(\n    comparisons = list(\n      c(\"Chinstrap\", \"Gentoo\"),\n      c(\"Gentoo\", \"Adelie\")\n    ),\n    test = \"wilcox.test\",\n    y_position = c(216, 218),\n    map_signif_level = TRUE,\n    tip_length = 0.01\n  )\n```\n\n::: {.cell-output-display}\n![](tests_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}